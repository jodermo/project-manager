
  <b *ngIf="label">{{adminService.text(label)}}</b>


<div *ngIf="editPoi">
  <mat-form-field class="backend-admin-form-field" appearance="fill">
    <mat-label>{{adminService.text('Select Location')}}</mat-label>
    <mat-select [(ngModel)]="editPoi" (ngModelChange)="selectPoiChange()">
      <mat-option [value]="newPoi">
        {{adminService.text('New Location')}}
      </mat-option>
      <mat-option *ngFor="let poi of adminService.apiData['poi']" [value]="poi">
        {{poi.name}}
      </mat-option>
    </mat-select>
  </mat-form-field>
</div>
<ng-container *ngIf=" layout === 'simple'">
  <div class="poi-entry" *ngIf="editPoi">
  </div>
  <div class="poi-entry" *ngIf="!editPoi && poi">

    <div>
      {{poi.name}}
    </div>
    <div class="horizontal-flex">
      <div>
        {{adminService.text('Latitude')}}: {{poi.latitude}}
      </div>
      <span class="spacer"></span>
      <div>
        {{adminService.text('Longitude')}}: {{poi.latitude}}
      </div>
    </div>
  </div>
</ng-container>
<ng-container *ngIf="layout !== 'simple'">
  <div class="poi-entry" *ngIf="editPoi">
    <div class="poi-map" *ngIf="mapVisible">
      <app-poi-map [showCursor]="true" [updatePoi]="editLocation" [autoSavePoi]="editLocation" [poi]="editPoi"
                   [latitude]="editPoi.latitude" [longitude]="editPoi.longitude"
                   [userInteraction]="editLocation"></app-poi-map>
    </div>
    <div *ngIf="!mapVisible">


      <mat-form-field class="backend-admin-form-field" appearance="fill">
        <mat-label>{{adminService.text('Name')}}</mat-label>
        <input matInput type="text" name="name"
               [(ngModel)]="editPoi.name">
      </mat-form-field>
      <div class="horizontal-flex">
        <mat-form-field class="backend-admin-form-field" appearance="fill">
          <mat-label>{{adminService.text('Latitude')}}</mat-label>
          <input matInput type="text" name="latitude"
                 [disabled]="clientLocationComponent.loading"
                 [(ngModel)]="editPoi.latitude">
        </mat-form-field>
        <mat-form-field class="backend-admin-form-field" appearance="fill">
          <mat-label>{{adminService.text('Longitude')}}</mat-label>
          <input matInput type="text" name="longitude"
                 [disabled]="clientLocationComponent.loading"
                 [(ngModel)]="editPoi.longitude">
        </mat-form-field>

        <app-get-client-location [confirm]="true" (onGetGeolocation)="setGeolocation($event)"
                                 #clientLocationComponent></app-get-client-location>
      </div>
      <div class="horizontal-flex flex-gap flex-wrap">

        <app-image-upload *ngIf="editable && editPoi.id" [entry]="editPoi" [fieldKey]="'imageId'"
                          [label]="adminService.text('Location Image')"></app-image-upload>

        <div class="vertical-flex">
          <div class="flex-item">
            <app-image-upload *ngIf="editable && editPoi.id" [entry]="editPoi" [fieldKey]="'markerImageId'"
                              [label]="adminService.text('Marker Image')"></app-image-upload>
          </div>
          <div>
            <app-marker-preview *ngIf="editMarkerSrc" [src]="editMarkerSrc"></app-marker-preview>
          </div>
        </div>


        <app-image-upload *ngIf="editable && editPoi.id" [entry]="editPoi" [fieldKey]="'locationPreviewImageId'"
                          [label]="adminService.text('Location Preview')"></app-image-upload>

      </div>
    </div>
    <mat-toolbar *ngIf="controls">
      <button mat-icon-button (click)="mapVisible = !mapVisible"
              [ngClass]="{active:(mapVisible)}"
      >
        <mat-icon>map</mat-icon>
      </button>
      <button mat-icon-button *ngIf="mapVisible" (click)="setEditLocation(!editLocation)"
              [ngClass]="{active:(editLocation)}"
      >
        <mat-icon *ngIf="!editLocation">edit</mat-icon>
        <mat-icon *ngIf="editLocation">close</mat-icon>
      </button>
      <span class="spacer"></span>
      <button mat-icon-button (click)="savePoi()" [disabled]="!editPoi.name">
        <mat-icon>save</mat-icon>
      </button>
    </mat-toolbar>
  </div>
  <div class="poi-entry" *ngIf="!editPoi && poi">
    <div>
      {{poi.name}}
    </div>
    <div *ngIf="mapVisible">
      <app-poi-map [poi]="poi"></app-poi-map>
    </div>
    <div *ngIf="!mapVisible">

      <div class="horizontal-flex">
        <div>
          {{adminService.text('Latitude')}}: {{poi.latitude}}
        </div>
        <span class="spacer"></span>
        <div>
          {{adminService.text('Longitude')}}: {{poi.latitude}}
        </div>
      </div>

      <div class="horizontal-flex flex-wrap">
        <app-image-upload *ngIf="editable && poi.id" [entry]="poi" [fieldKey]="'imageId'"
                          [label]="adminService.text('Location Image')"></app-image-upload>

        <div class="vertical-flex">
          <div class="flex-item">
            <app-image-upload *ngIf="editable && poi.id" [entry]="poi" [fieldKey]="'markerImageId'"
                              [label]="adminService.text('Marker Image')"></app-image-upload>
          </div>
          <div>
            <app-marker-preview *ngIf="markerSrc" [src]="markerSrc"></app-marker-preview>
          </div>
        </div>


        <app-image-upload *ngIf="editable && poi.id" [entry]="poi" [fieldKey]="'locationPreviewImageId'"
                          [label]="adminService.text('Location Preview')"></app-image-upload>
      </div>




    </div>


    <mat-toolbar *ngIf="controls">
      <button mat-icon-button (click)="toggleMap()"
              [ngClass]="{active:(mapVisible)}"
      >
        <mat-icon>map</mat-icon>
      </button>
      <span class="spacer"></span>
      <button *ngIf="editable" mat-icon-button (click)="toggleEditMap()">
        <mat-icon>edit</mat-icon>
      </button>
    </mat-toolbar>
  </div>
</ng-container>



